<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Orbital VA – Pilots List</title>
<link rel="icon" href="favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<style>
/* ================================
   ORBITAL – GLOBAL STYLE (Inline)
================================ */
:root {
  --bg-main: #0b1020;
  --bg-panel: #111831;
  --bg-card: #161f3d;
  --accent-blue: #4da6ff;
  --accent-purple: #7b5cff;
  --accent-pink: #ff5fa2;
  --text-main: #e6ebff;
  --text-muted: #9aa4d6;
  --success: #4cff9f;
  --danger: #ff4d4d;
  --border-glow: rgba(77,166,255,0.4);
}

body {
  margin: 0;
  background: radial-gradient(circle at top, #111831, var(--bg-main));
  font-family: 'Poppins', sans-serif;
  color: var(--text-main);
}

/* ================================
   APP LAYOUT
================================ */
.app {
  display: flex;
  min-height: 100vh;
}

/* ================================
   SIDEBAR
================================ */
.sidebar {
  width: 260px;
  background: linear-gradient(180deg, #0d1430, #0a0f24);
  padding: 25px 15px;
  box-shadow: inset -1px 0 0 rgba(255,255,255,0.05);
}

.sidebar h2 {
  font-family: 'Orbitron', sans-serif;
  text-align: center;
  color: var(--accent-blue);
  margin-bottom: 35px;
}

.sidebar a {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 15px;
  margin-bottom: 12px;
  color: var(--text-main);
  text-decoration: none;
  border-radius: 12px;
  transition: 0.3s;
}

.sidebar a i {
  color: var(--accent-purple);
}

.sidebar a:hover,
.sidebar a.active {
  background: rgba(77,166,255,0.15);
  box-shadow: inset 0 0 15px rgba(77,166,255,0.25);
}

/* ================================
   MAIN CONTENT
================================ */
.main {
  flex: 1;
  padding: 40px;
}

.main h1 {
  font-family: 'Orbitron', sans-serif;
  margin-bottom: 10px;
  color: var(--accent-blue);
}

.main p.muted {
  color: var(--text-muted);
  margin-bottom: 25px;
}

/* ================================
   TABLE (Airtable Style)
================================ */
table {
  width: 100%;
  border-collapse: collapse;
  background: var(--bg-panel);
  border-radius: 14px;
  overflow: hidden;
}

thead {
  background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
}

th, td {
  padding: 14px;
  text-align: center;
  font-size: 14px;
  color: var(--text-main);
}

tbody tr {
  border-bottom: 1px solid rgba(255,255,255,0.05);
  cursor: pointer;
}

tbody tr:hover {
  background: rgba(77,166,255,0.15);
}

tbody tr.selected {
  outline: 2px solid var(--accent-pink);
}

/* ================================
   RESPONSIVE
================================ */
@media(max-width: 900px) {
  .sidebar { width: 220px; }
}

@media(max-width: 700px) {
  .app { flex-direction: column; }
  .sidebar { width: 100%; display: flex; overflow-x: auto; }
  .sidebar a { flex: 1; justify-content: center; }
}
</style>

</head>
<body>

<div class="app">

  <!-- SIDEBAR -->
<nav class="sidebar">
  <h2>ORBITAL VA</h2>
<a href="orbital-va-manager.html">
    <i class="fas fa-chart-line"></i> Dashboard
  </a>
  <a href="va/orbital/stats.html">
    <i class="fas fa-chart-bar"></i> VA Statistics
  </a>
  <a href="va/orbital/pireps-validation.html">
    <i class="fas fa-clipboard-check"></i> PIREPs Validation
  </a>
  <a href="va/orbital/manager-leaderboard.html">
    <i class="fas fa-trophy"></i> Pilot Leaderboard
  </a>
  <a href="create-event.html">
    <i class="fas fa-calendar-plus"></i> New Event
  </a>
  <a href="va/orbital/manager-events.html">
    <i class="fas fa-calendar-alt"></i> VA Events
  </a>
  <a href="va/orbital/manager-routes.html">
    <i class="fas fa-route"></i> VA Routes
  </a>
  <a href="va/orbital/manager-pilots.html">
    <i class="fas fa-users"></i> Pilots List
  </a>
</nav>
  <!-- MAIN CONTENT -->
  <main class="main">
    <h1>Orbital Pilots</h1>
    <p class="muted">List of all pilots in your VA</p>

    <table id="pilotsTable">
      <thead>
        <tr>
          <th>IFC Username</th>
          <th>Callsign</th>
          <th>Role</th>
          <th>Grade</th>
          <th>Number of PIREPs</th>
        </tr>
      </thead>
      <tbody>
        <!-- Pilots added dynamically -->
      </tbody>
    </table>
  </main>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA-KQGhyjrVhcstiQfqKcDQkiJjQQXf19M",
  authDomain: "orbital---va-manager.firebaseapp.com",
  projectId: "orbital---va-manager",
  storageBucket: "orbital---va-manager.firebasestorage.app",
  messagingSenderId: "162057702983",
  appId: "1:162057702983:web:f8ed3f5d115c7c53cbeb62"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async user => {
  if (!user) { window.location.href = "../../index.html"; return; }

  // Vérifier que c'est bien un manager
  const userSnap = await getDocs(query(collection(db, "users"), where("uid", "==", user.uid)));
  const userData = userSnap.docs[0]?.data();
  if (userData?.role !== "manager") {
    alert("Access denied. You are not a VA manager.");
    window.location.href = "../../home.html";
    return;
  }

  // Récupérer tous les pilotes de la VA "orbital"
  const pilotsSnap = await getDocs(query(collection(db, "users"), where("va", "==", "orbital")));
  const pilots = pilotsSnap.docs.map(doc => doc.data());

  const tbody = document.querySelector("#pilotsTable tbody");
  tbody.innerHTML = "";

  pilots.forEach(pilot => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${pilot.ifcUsername || "-"}</td>
      <td>${pilot.callsign || "-"}</td>
      <td>${pilot.role || "-"}</td>
      <td>${pilot.grade || "-"}</td>
      <td>${pilot.pireps ?? 0}</td>
    `;
    tr.addEventListener("click", () => {
      document.querySelectorAll("#pilotsTable tbody tr").forEach(r => r.classList.remove("selected"));
      tr.classList.add("selected");
    });
    tbody.appendChild(tr);
  });
});
</script>

</body>
</html>









